@model DI.Models.AddPlot

@{
    ViewBag.Title = "AddPlot";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using System.Data;
@using DI.Models;
@using DI.DAL;
@using DI.BLL;

@{ 
    //var grid = new WebGrid(Model, rowsPerPage: 20);
    DataTable dt = new CommonDA().Getplot(-1, -1, "", "", CommonBL.Setdate("01/01/1990"), DateTime.Now, "", "");
}


<div class="portlet-title">
    <div class="caption font-green">
        <i class="icon-pin font-green"></i>
        <span class="caption-subject bold uppercase"> जनपद में स्थापित औद्योगिक आस्थानो के भूखंड विवरण </span>
    </div>
</div>

<div class="row">
    <div class="col-md-12">
        <div class="portlet light bordered">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-equalizer font-red-sunglo"></i>
                    <span class="caption-subject font-red-sunglo bold uppercase">औद्योगिक आस्थानों में भूखंड जोड़े </span>
                    <span class="caption-helper">... </span>
                </div>
                @*<div class="tools">
                        <a href="" class="collapse" data-original-title="" title=""> </a>
                        <a href="#portlet-config" data-toggle="modal" class="config" data-original-title="" title=""> </a>
                        <a href="" class="reload" data-original-title="" title=""> </a>
                        <a href="" class="remove" data-original-title="" title=""> </a>
                    </div>*@
            </div>
            <div class="portlet-body form">
                <!-- BEGIN FORM-->
                <form action="#" class="form-horizontal">
                    <div class="form-body" style="padding: 0px !important">
                        @*<h3 class="form-section">Info</h3>*@

                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12 " style="text-align:left">आस्थान का नाम </label>
                                    <div class="col-md-12">
                                        @Html.DropDownListFor(m => m.IndustrialEstate, Model.IndustrialEstate, "Select", new { @id = "ddlIndustrialArea", @class = "form-control" })
                                        <input id="hfPlotCode" type="hidden" value="-1" />
                                        @*@Html.TextBoxFor(m => m.tbl_IndustrialAreaCode, new { @class = "form-control", @id = "txthouse_Name", @placeholder = "आस्थान का नाम" })*@
                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12" style="text-align:left">भूखंड क्रमांक</label>
                                    <div class="col-md-12">
                                        @Html.TextBoxFor(m => m.PlotSerial, new { @class = "form-control", @id = "txtPlotnumber", @placeholder = "भूखंड क्रमांक", @onkeypress = "return IsNumeric(event);", @Maxlength = 15 })
                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-col-md-12" style="text-align:left; margin-left:20px"> भूखंड का नाम </label>
                                    <div class="col-md-12">
                                        @Html.TextBoxFor(m => m.PlotName, new { @class = "form-control", @id = "txtPlot_name", @placeholder = "भूखंड का नाम ", @Maxlength = 50 })
                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12 " style="text-align:left">क्षेत्रफल </label>
                                    <div class="col-md-12">
                                        @Html.TextBoxFor(m => m.PlotArea, new { @class = "form-control", @id = "txtArea", @placeholder = "क्षेत्रफल ", @onkeypress = "return IsNumeric(event);", @Maxlength = 10 })
                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                        </div>
                        <!--/row-->

                        <div class="row">
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12 " style="text-align:left">क्या भूखंड आवंटित है ? </label>
                                    <div class="col-md-12">
                                        @Html.CheckBoxFor(m => m.IsPlot_Assigned, new { @name = "plotallottedCheckBox", @id = "plotallottedYes", @class = "make-switch"  })

                                        @*<label>
                                            This Switch is Set to
                                            <label id="CheckBoxValue" value="None"></label>
                                            </label>*@
</div>
                                </div>
                            </div>
                            <!--/span-->
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12 " style="text-align:left">क्या भूखंड विवादित है ? </label>
                                    <div class="col-md-12">
                                        @Html.CheckBoxFor(m => m.IsPlot_Disputed, new { @name = "PlotdisputedCheckBox", @id = "PlotdisputedYes", @class = "make-switch" })

                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12" style="text-align:left">भूखंड का विवरण </label>
                                    <div class="col-md-12">
                                        @Html.TextBoxFor(m => m.Plot_Desc, new { @class = "form-control", @id = "txtPlotdescription", @placeholder = "भूखंड का विवरण" })

                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                            <div class="col-md-3">
                                <div class="form-group">
                                    <label class="control-label col-md-12" style="text-align:left"> आवंटी का विवरण  </label>
                                    <div class="col-md-12">
                                        @Html.TextBoxFor(m => m.Plot_Allottee_Desc, new { @class = "form-control", @id = "txtAllotteeDetails", @placeholder = "आवंटी का विवरण" })
                                    </div>
                                </div>
                            </div>
                            <!--/span-->
                        </div>
                        <!--/row-->

                    </div>
                    <div class="form-actions">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="row">
                                    <div class="col-md-offset-12 col-md-12" align="right">
                                        <button type="submit" class="btn green" onclick="Save(false)" id="btnsave">Submit</button>
                                        <button type="button" class="btn red" onclick="res()">Cancel</button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6"> </div>
                        </div>
                    </div>
                </form>
                <!-- END FORM-->
            </div>
        </div>
    </div>
</div>


<!-- Begin: life time stats -->
<div class="portlet light">
    <div class="portlet-title">
        <div class="caption">
            <i class="fa fa-th-list"></i>भूखंड विवरण एवं संशोधन
        </div>
        <div class="actions">

            <div class="btn-group">
                <a class="btn btn-circle btn-default dropdown-toggle" href="javascript:;" data-toggle="dropdown">
                    <i class="fa fa-share"></i>
                    <span class="hidden-xs"> Tools </span>
                    <i class="fa fa-angle-down"></i>
                </a>
                <div class="dropdown-menu pull-right">
                    <li>
                        <a href="javascript:;"> Export to Excel </a>
                    </li>
                    <li>
                        <a href="javascript:;"> Export to CSV </a>
                    </li>
                    <li>
                        <a href="javascript:;"> Export to XML </a>
                    </li>

                </div>
            </div>
        </div>
    </div>
    <div class="portlet-body">
        <div class="table-container">
            <div class="table-actions-wrapper">
                <span> </span>
                <select class="table-group-action-input form-control input-inline input-small input-sm">
                    <option value="">Select...</option>
                    <option value="publish">विवादित </option>
                    <option value="unpublished">आवंटित </option>
                    <option value="delete">उपलब्ध </option>
                </select>
                <button class="btn btn-sm btn-success table-group-action-submit">
                    <i class="fa fa-check"></i> खोजें
                </button>
            </div>
            <table class="table table-striped table-bordered table-hover table-checkable" id="datatable_products">
                <thead>
                    <tr role="row" class="heading">
                        
                        <th width="10%"> क्र० सं० </th>
                        <th width="15%"> आस्थानों &nbsp;का नाम </th>
                        <th width="15%"> भूखंड&nbsp;का नाम </th>
                        <th width="15%"> भूखंड सं० </th>
                        <th width="10%"> क्षेत्रफल </th>
                        <th width="10%"> विवाद स्थिति </th>
                        <th width="15%"> आवंटन स्थिति </th>
                        <th width="10%"> भूखंड विवरण </th>
                        <th width="10%">  </th>
                        <th width="10%">  </th>
                    </tr>
                   
                       @if (dt != null)
                       {
                           if (dt.Rows.Count > 0)
                           {
                               for (int i = 0; i < dt.Rows.Count; i++)
                               {
                                <tr role="row" class="filter">
                                    <td>@(i + 1)</td>
                                    <td>@dt.Rows[i]["IndustrialEstate"].ToString().Trim()</td>
                                    <td>@dt.Rows[i]["PlotName"].ToString().Trim()</td>
                                    <td>@dt.Rows[i]["PlotSerial"].ToString().Trim()</td>
                                    <td>@dt.Rows[i]["Plot_Area"].ToString().Trim()</td>
                                    <td>@dt.Rows[i]["IsPlot_Disputed"].ToString().Trim()</td>
                                    <td>@dt.Rows[i]["IsPlot_Assigned"].ToString().Trim()</td>
                                    <td>@dt.Rows[i]["Plot_Desc"].ToString().Trim()</td>
                                    @*<td>@dt.Rows[i]["IndustrialArea"].ToString().Trim()</td>*@
                                    <td>
                                        <button type="submit" class="btn green" onclick="edit('@dt.Rows[i]["PlotCode"].ToString().Trim()','@dt.Rows[i]["tbl_IndustrialAreaCode"].ToString().Trim()','@dt.Rows[i]["PlotSerial"].ToString().Trim()','@dt.Rows[i]["PlotName"].ToString().Trim()','@dt.Rows[i]["Plot_Area"].ToString().Trim()','@dt.Rows[i]["IsPlot_Assigned"].ToString().Trim()','@dt.Rows[i]["IsPlot_Disputed"].ToString().Trim()','@dt.Rows[i]["Plot_Desc"].ToString().Trim()','@dt.Rows[i]["Plot_Allottee_Desc"].ToString().Trim()')">Edit</button>
                                    </td>
                                    <td>
                                        <button type="button" class="btn red" onclick="del('@dt.Rows[i]["PlotCode"].ToString().Trim()')">Delete</button>

                                    </td>
                                </tr>
                               }
                           }
                       }

                               
                </thead>
                <tbody> </tbody>
            </table>


          






        </div>
    </div>
</div>
<script>

    $('.make-switch').bootstrapSwitch('state', false);

    //$('#plotallottedYes').on('switchChange.bootstrapSwitch', function () {

    //    $("#CheckBoxValue").text($('#plotallottedYes').bootstrapSwitch('state'));
    //});


   // document.getElementsByName('IsPlot_Assigned').checked = true;
   // $('#plotallottedCheckBox').prop
    //$("#plotallottedCheckBox").prop('checked');
    //$('#CheckBoxValue').text($('.make-switch').bootstrapSwitch('state'));

    //$('#plotallottedCheckBox').on('switchChange.bootstrapSwitch', function () {

    //    $("#CheckBoxValue").text($('.make-switch').bootstrapSwitch('state'));
    //});
    //$('.make-switch').bootstrapSwitch('state', true);

    //$('#CheckBoxValue').text($("#plotallottedCheckBox").bootstrapSwitch('state'));
</script>
<script type="text/javascript">
    

    function res() {
        location.reload();
    }
        function Save(sptype)
                {
            if (document.getElementById("ddlIndustrialArea").value == "Select")
                    {
                document.getElementById("ddlIndustrialArea").focus();
                alert("आस्थान का नाम");
                        return;
            }
            if (document.getElementById("txtPlotnumber").value == "") {
                document.getElementById("txtPlotnumber").focus();
                alert("भूखंड क्रमांक");
                return;
            }
            if (document.getElementById("txtPlot_name").value == "") {
                document.getElementById("txtPlot_name").focus();
                alert("भूखंड का नाम");
                return;
            }
            if (document.getElementById("txtArea").value == "") {
                document.getElementById("txtArea").focus();
                alert("क्षेत्रफल");
                return;
            }
            if (document.getElementById("txtArea").value == "") {
                document.getElementById("txtArea").focus();
                alert("क्षेत्रफल");
                return;
            }
            var IsPlot_Assigned = $('#plotallottedYes').bootstrapSwitch('state');
            var IsPlot_Disputed = $('#PlotdisputedYes').bootstrapSwitch('state');
                    var M01 = {
                        "PlotCode": document.getElementById("hfPlotCode").value,
                        "IndustrialEstateCode": document.getElementById("ddlIndustrialArea").value,
                        "PlotSerial": document.getElementById("txtPlotnumber").value,
                        "PlotName": document.getElementById("txtPlot_name").value,
                        "PlotArea": document.getElementById("txtArea").value,
                        "IsPlot_Assigned": IsPlot_Assigned,//document.getElementById("plotallottedYes").value, $('#plotallottedYes').bootstrapSwitch('state')
                        "IsPlot_Disputed": IsPlot_Disputed,//document.getElementById("PlotdisputedYes").value, $('#PlotdisputedYes').bootstrapSwitch('state')
                        "Plot_Desc": document.getElementById("txtPlotdescription").value,
                        "Plot_Allottee_Desc": document.getElementById("txtAllotteeDetails").value
                    }
                    $.ajax({
                        url: '/IndustrialAreaMaster/InsertUpdatePlot',
                        data: JSON.stringify({ M01: M01, sptype: sptype }),
                        type: 'POST',
                        contentType: 'application/json; charset=utf-8',
                        success: function (data) {
                            alert(data);
                            location.reload();
                        }
                    });
        }
        var specialKeys = new Array();
        specialKeys.push(47); // for Forward Slash(/)
        specialKeys.push(8); //Backspace
        specialKeys.push(9); // Tab
        specialKeys.push(46); // for .
        specialKeys.push(37); // for left Arrow
        specialKeys.push(39); // for Right Arrow
        function IsNumeric(e) {
            var keyCode = e.which ? e.which : e.keyCode
            var ret = ((keyCode >= 48 && keyCode <= 57) || specialKeys.indexOf(keyCode) != -1); // For Decimal To All Number
            if (ret == false) {
                alert("Only numaric value allwed.");
            }
            return ret;
        }
        function edit(PlotCode ,tbl_IndustrialAreaCode ,PlotSerial ,PlotName ,Plot_Area ,IsPlot_Assigned,IsPlot_Disputed,Plot_Desc ,Plot_Allottee_Desc) {
    
            document.getElementById("hfPlotCode").value= PlotCode;
            document.getElementById("ddlIndustrialArea").value= tbl_IndustrialAreaCode;
            document.getElementById("txtPlotnumber").value= PlotSerial;
            document.getElementById("txtPlot_name").value= PlotName;
            document.getElementById("txtArea").value= Plot_Area;
            if (IsPlot_Assigned=="Yes") 
            {
                //document.getElementById("plotallottedYes").checked = true;
                //$('#plotallottedYes').prop('checked', true);
                $('#plotallottedYes').bootstrapSwitch('state', true);
            }
            else {
                $('#plotallottedYes').bootstrapSwitch('state', false);

                //$('#plotallottedYes').prop('checked', false);
               // document.getElementById("plotallottedYes").checked = false;
            }
            if (IsPlot_Disputed=="Yes") 
            {
                //$('#PlotdisputedYes').prop('checked', true);
                $('#PlotdisputedYes').bootstrapSwitch('state', true);
                //document.getElementById("PlotdisputedYes").checked = true;
            }
            else {
               // $('#PlotdisputedYes').prop('checked', false);
                $('#PlotdisputedYes').bootstrapSwitch('state', false);

                //document.getElementById("PlotdisputedYes").checked = false;
            }

           
            document.getElementById("txtPlotdescription").value= Plot_Desc;
            document.getElementById("txtAllotteeDetails").value = Plot_Allottee_Desc;
            $('#btnsave').html('Update');

        }


        function del(X) {


            var M01 = {
                "PlotCode": X,
                "IndustrialEstateCode": "-1",
                "PlotSerial":  "X",
                "PlotName":  "X" ,
                "PlotArea":  "X",
                "IsPlot_Assigned":  "X",//document.getElementById("plotallottedYes").value,
                "IsPlot_Disputed":  "X",//document.getElementById("PlotdisputedYes").value,
                "Plot_Desc":  "X",
                "Plot_Allottee_Desc": "X",

            }
            $.ajax({
                url: '/IndustrialAreaMaster/InsertUpdatePlot',
                data: JSON.stringify({ M01: M01, sptype: true }),
                type: 'POST',
                contentType: 'application/json; charset=utf-8',
                success: function (data) {
                    alert(data);
                    location.reload();
                }
            });
        }

</script>
<!-- End: life time stats -->
